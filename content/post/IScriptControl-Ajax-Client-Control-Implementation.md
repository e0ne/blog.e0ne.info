---
title: "IScriptControl - реализация Ajax Client Control"
date: 2010-02-05T13:20:00+03:00
draft: False
category: [.NET Framework,Web Development]
tags: []
archives: [2010]
aliases:
    - post/IScriptControl-Ajax-Client-Control-Implementation.aspx
---


Почему-то, не смотря на свойственную для всех программистов лень (и не надо спорить, иначе бы мы не писаи кучу софта, который упрощает на жизнь и позволяет более легким способом добиться желаемого результата), все многие пытаются изобрести свой велосипед.

Я и сам придумал не один способ, как обмениваться данными между серверной и клиентской частью контрола. Но всегда догадывался, что есть более простой и "правильный" путь, особенно, когда смотрел на реализацию контролов из набора AjaxControlToolkit,

Реализация интерфейса IScriptControl, который состоит из 2-х методов, помагает реализовать нужную задачу в несколько строк кода (не считая, конечно-то ещё нескольких строчек на JavaScript).

 

<img src="/image.axd?picture=2010%2f1%2f0.jpg" alt="" />

 

- В методе GetScriptDescriptors() мы создаём дескрипторы в которых говорим какие клиентские свойства должны быть у контрола.
- Метод GetScriptReferences() возвращает список клиентских скриптов, которые нам нужны и будут автоматически загружены с помощью ScriptManager.

 

<img src="/image.axd?picture=2010%2f2%2f1.jpg" alt="" />

С серверной стороной закончили. Теперь осталось совсем немного написать на JavaScript. Как всегда, большую часть за нас сделала Microsoft. Добавляем в проект js-файл типа AJAX ClientControl:

<img src="/image.axd?picture=2010%2f2%2f2.jpg" alt="" />

Для нас создастса уже готовый прототик контрола, где нам останется только объявить все наши свойства, getters & setters для них, события и методы. 

Не могу сказать что описаннный способ лучше(выше, быстрее) других, но он позволяет легко создавать серверные комнонеты с клиентской частью и избавить себя от многой рутинной работы. Также, значительно приятнее смотреть на более-менее стандартизовынный код, пусть даже этот стандарт создан разработчиками из Microsoft.

Хочу заметить, что всё описанное выше без каких-либо изминений можно применять только для WebControl. Если же нужно сделать UserControl, то в нём нужно поместить какой-либо контейнер (e.g. ) и при создании дескрипторов указывать ID контейнера, иначе вы получите клиентскуб ошибку что не к сему привязать js объект.

Более подробно о каждом шаге можно почитать по ссылке [http://en.csharp-online.net/Creating_Custom_ASP.NET_AJAX_Client_Controls—IScriptControl.GetScriptDescriptors_Method](http://en.csharp-online.net/Creating_Custom_ASP.NET_AJAX_Client_Controls%E2%80%94IScriptControl.GetScriptDescriptors_Method) и в [MSDN](http://msdn.microsoft.com/en-us/library/system.web.ui.iscriptcontrol.aspx).

[ScriptControlTest.zip (7.95 kb)](/file.axd?file=2010%2f2%2fScriptControlTest.zip)

